<?xml version="1.0" encoding="UTF-8"?>
<!-- status=off 查看log4j2的装配过程，monitorInterval=60 自动检测配置文件的修改，单位为秒 -->
<configuration status="off" monitorInterval="60">

	<!-- 日志目录 -->
	<properties>
		<!-- 日志主目录 -->
		<property name="LOG_HOME">D:\</property>
		<!-- 日志备份目录 -->
		<property name="BACKUP_HOME">${LOG_HOME}\backup\</property>
		<!-- 多个tomcat，分端口目录 -->
		<property name="SERVER_NAME">log</property>
		<!-- 日志状态目录 -->
		<property name="STATUS_NAME">error</property>
	</properties>

	<!-- 日志位置 -->
	<appenders>

		<!-- 控制台 -->
		<Console name="Console" target="SYSTEM_OUT" follow="true">
			<PatternLayout
				pattern="%date{yyyy-MM-dd HH:mm:ss.SSS} %-5level [%class(%method:%line)] - %msg%n" />
		</Console>

		<!-- 文件 -->
		<RollingRandomAccessFile name="File"
			fileName="${LOG_HOME}\${SERVER_NAME}.log" filePattern="${BACKUP_HOME}\${SERVER_NAME}.%d{yyyy-MM-dd}.log">
			<PatternLayout
				pattern="%date{yyyy-MM-dd HH:mm:ss.SSS} %-5level [%class(%method:%line)] - %msg%n" />
			<!-- 分文件存储策略 -->
			<Policies>
				<!-- 按照时间拆分 -->
				<!-- interval 两次封存日志的时间间隔，单位通过日志的命名精度确定，yyyy-MM-dd HH单位为小时、yyyy-MM-dd 
					HH:mm单位为分钟；modulate为true，封存日志时间将以0点为边界进行偏移计算 -->
				<!-- 例如：上次封存日志的时间为04:00，下次封存日志的时间为05:00，之后封存日志的时间依次为06:00、07:00、08:00、。。。 -->
				<TimeBasedTriggeringPolicy interval="1"
					modulate="true" />
				<!-- 按照文件大小拆分 -->
				<!-- <SizeBasedTriggeringPolicy size="10 MB" /> -->
			</Policies>
		</RollingRandomAccessFile>

		<!-- 特殊状态日志，按照小时切分 -->
		<RollingRandomAccessFile name="Status"
			fileName="${LOG_HOME}\${SERVER_NAME}_${STATUS_NAME}.log"
			filePattern="${BACKUP_HOME}\${SERVER_NAME}_${STATUS_NAME}.%d{yyyy-MM-dd-HH}.log">
			<!-- 只输出level及以上级别的信息onMatch，其它的不输出onMismatch -->
			<ThresholdFilter level="${STATUS_NAME}" onMatch="ACCEPT"
				onMismatch="DENY" />
			<PatternLayout
				pattern="%date{yyyy-MM-dd HH:mm:ss.SSS} %-5level [%class(%method:%line)] - %msg%n" />
			<Policies>
				<!-- 按照时间拆分 -->
				<!-- interval 两次封存日志的时间间隔，单位通过日志的命名精度确定，yyyy-MM-dd HH单位为小时、yyyy-MM-dd 
					HH:mm单位为分钟；modulate为true，封存日志时间将以0点为边界进行偏移计算 -->
				<!-- 例如：上次封存日志的时间为04:00，下次封存日志的时间为05:00，之后封存日志的时间依次为06:00、07:00、08:00、。。。 -->
				<TimeBasedTriggeringPolicy interval="1"
					modulate="true" />
				<!-- 按照文件大小拆分 -->
				<!-- <SizeBasedTriggeringPolicy size="10 MB" /> -->
			</Policies>
		</RollingRandomAccessFile>

	</appenders>

	<!-- 日志级别 -->
	<loggers>
		<root level="debug">
			<appender-ref ref="Console" />
			<appender-ref ref="File" />
			<appender-ref ref="Status" />
		</root>
	</loggers>

</configuration>